@(query: Query, answer: Answer, maxSentenceCount: Int, debug: Boolean)

@import models.TypeFilters._
@import edu.washington.cs.knowitall.browser.extraction.NellType.fbToNellType

@titleLink(part: models.AnswerTitlePart) = {
	@if(part.extractionPart == Relation) {
		@part.text
	} else {
		<a href='@routes.Application.search(Option(part.text),Option(""),Option(""),"all",0,debug)'>@part.text</a>
	}
}

@defining(answer.title.parts.head) { partsHead =>

	<!-- title -->
	<h2>@{Html(answer.title.parts.map { part =>
			titleLink(part)
		}.mkString(answer.title.connector))}</h2>

	<!-- if there is an entity, display its FreeBase URI -->
	@defining(partsHead.entity) { entityOpt =>
		@entityOpt match{
			case Some(entity) => {

				<!-- FreeBase URI -->
				<h3 class='uri-title'>URI:</h3>
				<ul class='uri-body'>
					<li><a href='http://www.freebase.com/view/m/@entity.fbid'>http://www.freebase.com/view/m/@entity.fbid</a></li>
				</ul>
			}

			case None => {}
		}
	} 

	<!-- if there are types, display them -->
	@if(partsHead.types.size > 0) {
		<h3 class='types-title'>Types:</h3>
		<ul class='types-body'>
			@partsHead.types.toSeq.sortBy(-_.weight).map{ fbType =>
			<li><a href='http://www.freebase.com/view@{fbType.name}' title='FreeBase type: @{fbType.name}'>@{fbType.name}</a></li>
			}
		</ul>
	}

	<!-- if there are synonyms, display them -->
	@if(partsHead.otherSynonyms.size > 0) {
		<h3 class='syns-title'>Extracted Synonyms:</h3>
		<ul class='syns-body'>
			@partsHead.otherSynonyms.map { synonym =>
			<li>@synonym</li>
			}
		</ul>
	}

	<!-- display sentences -->
	<h3>Extracted from these sentences:</h3>
	@helper.sentences(answer.copy(contents=answer.contents.take(maxSentenceCount)), debug)

	@if(answer.contents.size > maxSentenceCount) {
		<p style="text-align: center; margin-top: 1em"><a href="@{routes.Application.sentences(query.arg1.map(_.toString), query.rel.map(_.toString), query.arg2.map(_.toString), answer.title.text, debug)}">Show all sentences (@{answer.contents.size - maxSentenceCount} more)</a></p>
	}
}
